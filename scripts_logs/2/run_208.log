[2025-11-15 00:36:41,675] INFO: Task received by worker
[2025-11-15 00:36:41,676] INFO: Starting task: AI Product Analyzer
[2025-11-15 00:36:41,676] DEBUG: Input data: {
  "AI_MODEL": "claude"
}
[2025-11-15 00:36:41,769] INFO: CLI Processor initialized
[2025-11-15 00:36:41,770] INFO: STARTING PRODUCT PROCESSING PIPELINE
[2025-11-15 00:36:41,770] INFO: ==============================
[2025-11-15 00:36:41,770] INFO: STAGE 1: IMPORTING DATA
[2025-11-15 00:36:41,770] INFO: ==============================
[2025-11-15 00:36:41,770] INFO: ✅ Successfully imported 10 products from JSON
[2025-11-15 00:36:41,770] INFO: STAGE 2-3: PROCESSING PRODUCTS (TITLE GENERATION + PRICE FETCHING)
[2025-11-15 00:36:41,770] INFO: [1/10] Processing: Canon Printer Cartridge Pixma 561 XL
[2025-11-15 00:36:41,770] INFO: → Generating AI title...
[2025-11-15 00:36:44,150] ERROR: Error generating title: name 'logger' is not defined
Traceback (most recent call last):
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/retry_with_backoff.py", line 17, in retry_with_backoff
    result = func()
             ^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/openai_model.py", line 58, in call_openai
    return self.client.chat.completions.create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/venv/lib/python3.12/site-packages/openai/_utils/_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/venv/lib/python3.12/site-packages/openai/resources/chat/completions/completions.py", line 1189, in create
    return self._post(
           ^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/venv/lib/python3.12/site-packages/openai/_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/venv/lib/python3.12/site-packages/openai/_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
openai.BadRequestError: Error code: 400 - {'error': {'message': 'Error while downloading https://scontent.ftas4-4.fna.fbcdn.net/v/t45.5328-4/577878337_701786592510951_7391931636100232931_n.jpg?stp=dst-jpg_s960x960_tt6&_nc_cat=105&ccb=1-7&_nc_sid=247b10&_nc_ohc=TBAiIXj5JWMQ7kNvwFCbPNB&_nc_oc=Adm6B6u7SN84eg8eVlQ-GN_DieDoHEis3fzj8Q_rapj6Hp5B1qYR9-v2ZqA5ZAlSgYQ&_nc_zt=23&_nc_ht=scontent.ftas4-4.fna&_nc_gid=Xjz3B3ZDNXieJaz8mv8E9A&oh=00_AfjdIq0utaxor2eco5_o4tYwzOqtWF4rLWVnmew4mkd1vQ&oe=691DB431.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_image_url'}}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/retry_with_backoff.py", line 17, in retry_with_backoff
    result = func()
             ^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/title_generator.py", line 36, in ai_call
    return self.ai_router.generate_title(prompt, image_urls, schema)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/ai_model_router.py", line 69, in generate_title
    return model.generate_title(prompt, image_urls, schema)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/openai_model.py", line 70, in generate_title
    success, response, error = retry_with_backoff(call_openai)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/retry_with_backoff.py", line 21, in retry_with_backoff
    logger.info(error)
    ^^^^^^
NameError: name 'logger' is not defined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/title_generator.py", line 38, in generate_title
    success, response, error = retry_with_backoff(ai_call)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/retry_with_backoff.py", line 21, in retry_with_backoff
    logger.info(error)
    ^^^^^^
NameError: name 'logger' is not defined
[2025-11-15 00:36:44,170] INFO: → Fetching Amazon prices for sub-products...
[2025-11-15 00:36:44,170] WARNING: No sub-products identified, skipping price fetch
[2025-11-15 00:36:44,170] INFO: [2/10] Processing: Two Empty Ink Canon Printer Cartridges . (Collect Brentford Tw8 0de)
[2025-11-15 00:36:44,170] INFO: → Generating AI title...
[2025-11-15 00:36:46,157] ERROR: Error generating title: name 'logger' is not defined
Traceback (most recent call last):
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/retry_with_backoff.py", line 17, in retry_with_backoff
    result = func()
             ^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/openai_model.py", line 58, in call_openai
    return self.client.chat.completions.create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/venv/lib/python3.12/site-packages/openai/_utils/_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/venv/lib/python3.12/site-packages/openai/resources/chat/completions/completions.py", line 1189, in create
    return self._post(
           ^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/venv/lib/python3.12/site-packages/openai/_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/venv/lib/python3.12/site-packages/openai/_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
openai.BadRequestError: Error code: 400 - {'error': {'message': 'Error while downloading https://scontent.ftas4-1.fna.fbcdn.net/v/t39.84726-6/579480737_671565662500101_5199736071936141284_n.jpg?_nc_cat=104&ccb=1-7&_nc_sid=92e707&_nc_ohc=KIjV_7EHxGkQ7kNvwEZBWrD&_nc_oc=Adm_t3KTIxVCJ5acGxAhQls3HTp6zlqN-qMM9G5Rt8q2iVI5uSCyfC6bKYS45kaI7Z8&_nc_zt=14&_nc_ht=scontent.ftas4-1.fna&_nc_gid=BUT3qcskjO_D5UKxqvQhJA&oh=00_AfhJOy7vqZ4mNLuOB5rech5xlkDjJhqsjW5KpQTRqd8aVg&oe=691DAD86.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_image_url'}}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/retry_with_backoff.py", line 17, in retry_with_backoff
    result = func()
             ^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/title_generator.py", line 36, in ai_call
    return self.ai_router.generate_title(prompt, image_urls, schema)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/ai_model_router.py", line 69, in generate_title
    return model.generate_title(prompt, image_urls, schema)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/openai_model.py", line 70, in generate_title
    success, response, error = retry_with_backoff(call_openai)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/retry_with_backoff.py", line 21, in retry_with_backoff
    logger.info(error)
    ^^^^^^
NameError: name 'logger' is not defined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/title_generator.py", line 38, in generate_title
    success, response, error = retry_with_backoff(ai_call)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/retry_with_backoff.py", line 21, in retry_with_backoff
    logger.info(error)
    ^^^^^^
NameError: name 'logger' is not defined
[2025-11-15 00:36:46,162] INFO: → Fetching Amazon prices for sub-products...
[2025-11-15 00:36:46,162] WARNING: No sub-products identified, skipping price fetch
[2025-11-15 00:36:46,162] INFO: [3/10] Processing: Canon Printer Cartridge XL 540
[2025-11-15 00:36:46,162] INFO: → Generating AI title...
[2025-11-15 00:36:47,738] ERROR: Error generating title: name 'logger' is not defined
Traceback (most recent call last):
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/retry_with_backoff.py", line 17, in retry_with_backoff
    result = func()
             ^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/openai_model.py", line 58, in call_openai
    return self.client.chat.completions.create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/venv/lib/python3.12/site-packages/openai/_utils/_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/venv/lib/python3.12/site-packages/openai/resources/chat/completions/completions.py", line 1189, in create
    return self._post(
           ^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/venv/lib/python3.12/site-packages/openai/_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/venv/lib/python3.12/site-packages/openai/_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
openai.BadRequestError: Error code: 400 - {'error': {'message': 'Error while downloading https://scontent.ftas4-1.fna.fbcdn.net/v/t39.84726-6/580575424_1777251659742157_7843720912310474827_n.jpg?stp=dst-jpg_p720x720_tt6&_nc_cat=100&ccb=1-7&_nc_sid=92e707&_nc_ohc=poU_utcGx_kQ7kNvwFGUSO0&_nc_oc=AdlsYL3DF8C_tutAZfteE9hMukSLTgazL6GcBk0g37ZiCRqN1N1lBs-QekiDjB5odT0&_nc_zt=14&_nc_ht=scontent.ftas4-1.fna&_nc_gid=XZ1AW6l0BBsFsEyD5CIVxg&oh=00_Afh6-vyMuNc5GRxCbZorBcJAI8F5KPbcrdTx-S5sb-qY9w&oe=691D821B.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_image_url'}}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/retry_with_backoff.py", line 17, in retry_with_backoff
    result = func()
             ^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/title_generator.py", line 36, in ai_call
    return self.ai_router.generate_title(prompt, image_urls, schema)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/ai_model_router.py", line 69, in generate_title
    return model.generate_title(prompt, image_urls, schema)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/openai_model.py", line 70, in generate_title
    success, response, error = retry_with_backoff(call_openai)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/retry_with_backoff.py", line 21, in retry_with_backoff
    logger.info(error)
    ^^^^^^
NameError: name 'logger' is not defined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/title_generator.py", line 38, in generate_title
    success, response, error = retry_with_backoff(ai_call)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/retry_with_backoff.py", line 21, in retry_with_backoff
    logger.info(error)
    ^^^^^^
NameError: name 'logger' is not defined
[2025-11-15 00:36:47,745] INFO: → Fetching Amazon prices for sub-products...
[2025-11-15 00:36:47,745] WARNING: No sub-products identified, skipping price fetch
[2025-11-15 00:36:47,753] INFO: [4/10] Processing: Brand new canon printer and cartridges
[2025-11-15 00:36:47,754] INFO: → Generating AI title...
[2025-11-15 00:36:48,967] ERROR: Error generating title: name 'logger' is not defined
Traceback (most recent call last):
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/retry_with_backoff.py", line 17, in retry_with_backoff
    result = func()
             ^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/openai_model.py", line 58, in call_openai
    return self.client.chat.completions.create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/venv/lib/python3.12/site-packages/openai/_utils/_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/venv/lib/python3.12/site-packages/openai/resources/chat/completions/completions.py", line 1189, in create
    return self._post(
           ^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/venv/lib/python3.12/site-packages/openai/_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/venv/lib/python3.12/site-packages/openai/_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
openai.BadRequestError: Error code: 400 - {'error': {'message': 'Error while downloading https://scontent.ftas4-4.fna.fbcdn.net/v/t39.84726-6/582490745_1637526523889224_3396530520218670805_n.jpg?stp=dst-jpg_s960x960_tt6&_nc_cat=103&ccb=1-7&_nc_sid=92e707&_nc_ohc=0cKOTO9tyo4Q7kNvwGR0qUP&_nc_oc=Adm9tzW3d0d8tr_CFvDCUNlMbjg7LP4qy_x8LlkkpUf8gCfOsATqrFtq_MUX9wIwcQY&_nc_zt=14&_nc_ht=scontent.ftas4-4.fna&_nc_gid=2C_A_fWY9sxaYYmJ6eKjLA&oh=00_AfixMSpjNbPJH90ZMLw6XY5joL-ZOxQhdDFR0VBqR_JS_Q&oe=691DA449.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_image_url'}}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/retry_with_backoff.py", line 17, in retry_with_backoff
    result = func()
             ^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/title_generator.py", line 36, in ai_call
    return self.ai_router.generate_title(prompt, image_urls, schema)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/ai_model_router.py", line 69, in generate_title
    return model.generate_title(prompt, image_urls, schema)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/openai_model.py", line 70, in generate_title
    success, response, error = retry_with_backoff(call_openai)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/retry_with_backoff.py", line 21, in retry_with_backoff
    logger.info(error)
    ^^^^^^
NameError: name 'logger' is not defined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/title_generator.py", line 38, in generate_title
    success, response, error = retry_with_backoff(ai_call)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/retry_with_backoff.py", line 21, in retry_with_backoff
    logger.info(error)
    ^^^^^^
NameError: name 'logger' is not defined
[2025-11-15 00:36:48,974] INFO: → Fetching Amazon prices for sub-products...
[2025-11-15 00:36:48,974] WARNING: No sub-products identified, skipping price fetch
[2025-11-15 00:36:48,982] INFO: [5/10] Processing: Canon Ink cartridges mixed bundle-open to offers
[2025-11-15 00:36:48,983] INFO: → Generating AI title...
[2025-11-15 00:36:50,045] ERROR: Error generating title: name 'logger' is not defined
Traceback (most recent call last):
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/retry_with_backoff.py", line 17, in retry_with_backoff
    result = func()
             ^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/openai_model.py", line 58, in call_openai
    return self.client.chat.completions.create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/venv/lib/python3.12/site-packages/openai/_utils/_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/venv/lib/python3.12/site-packages/openai/resources/chat/completions/completions.py", line 1189, in create
    return self._post(
           ^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/venv/lib/python3.12/site-packages/openai/_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/venv/lib/python3.12/site-packages/openai/_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
openai.BadRequestError: Error code: 400 - {'error': {'message': 'Error while downloading https://scontent.ftas4-4.fna.fbcdn.net/v/t45.5328-4/578123430_1310058154209322_3090805346223552646_n.jpg?stp=dst-jpg_p720x720_tt6&_nc_cat=103&ccb=1-7&_nc_sid=247b10&_nc_ohc=ZOTi3-MsHIQQ7kNvwElqfm-&_nc_oc=Adn012r9GMjlSI6HL31F5L--CflNYMv70aFxlAvRshZoNfdOLo4KUfNuoDQCqVLCuns&_nc_zt=23&_nc_ht=scontent.ftas4-4.fna&_nc_gid=vDLhh2I-LhdQo2XeU3Je2A&oh=00_AfjZMdBn-UZm-ijOJPPjNjsT2m93C6WfjVhr2e0YybN27w&oe=691DAD3B.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_image_url'}}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/retry_with_backoff.py", line 17, in retry_with_backoff
    result = func()
             ^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/title_generator.py", line 36, in ai_call
    return self.ai_router.generate_title(prompt, image_urls, schema)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/ai_model_router.py", line 69, in generate_title
    return model.generate_title(prompt, image_urls, schema)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/openai_model.py", line 70, in generate_title
    success, response, error = retry_with_backoff(call_openai)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/retry_with_backoff.py", line 21, in retry_with_backoff
    logger.info(error)
    ^^^^^^
NameError: name 'logger' is not defined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/title_generator.py", line 38, in generate_title
    success, response, error = retry_with_backoff(ai_call)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/retry_with_backoff.py", line 21, in retry_with_backoff
    logger.info(error)
    ^^^^^^
NameError: name 'logger' is not defined
[2025-11-15 00:36:50,062] INFO: → Fetching Amazon prices for sub-products...
[2025-11-15 00:36:50,062] WARNING: No sub-products identified, skipping price fetch
[2025-11-15 00:36:50,063] INFO: [6/10] Processing: Canon Printer Cartridges
[2025-11-15 00:36:50,063] INFO: → Generating AI title...
[2025-11-15 00:36:51,048] ERROR: Error generating title: name 'logger' is not defined
Traceback (most recent call last):
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/retry_with_backoff.py", line 17, in retry_with_backoff
    result = func()
             ^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/openai_model.py", line 58, in call_openai
    return self.client.chat.completions.create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/venv/lib/python3.12/site-packages/openai/_utils/_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/venv/lib/python3.12/site-packages/openai/resources/chat/completions/completions.py", line 1189, in create
    return self._post(
           ^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/venv/lib/python3.12/site-packages/openai/_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/venv/lib/python3.12/site-packages/openai/_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
openai.BadRequestError: Error code: 400 - {'error': {'message': 'Error while downloading https://scontent.ftas4-4.fna.fbcdn.net/v/t45.5328-4/578370479_1556734709093147_2370080912341461347_n.jpg?stp=dst-jpg_p720x720_tt6&_nc_cat=103&ccb=1-7&_nc_sid=247b10&_nc_ohc=YKMzs8sIlD8Q7kNvwEElxEk&_nc_oc=AdlHvOuxlpfMpEgfdoPdF72bbfgQbgZm9nwPcC6WEReRFX9hhaTNKoYpziQbpRD33Sc&_nc_zt=23&_nc_ht=scontent.ftas4-4.fna&_nc_gid=g_x_ebkGCsFq06qouG8hZg&oh=00_AfhA5FChDdwBIVUeuCdqqVaNtNOKHbAuYSuexZEX4ElQdQ&oe=691D9782.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_image_url'}}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/retry_with_backoff.py", line 17, in retry_with_backoff
    result = func()
             ^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/title_generator.py", line 36, in ai_call
    return self.ai_router.generate_title(prompt, image_urls, schema)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/ai_model_router.py", line 69, in generate_title
    return model.generate_title(prompt, image_urls, schema)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/openai_model.py", line 70, in generate_title
    success, response, error = retry_with_backoff(call_openai)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/retry_with_backoff.py", line 21, in retry_with_backoff
    logger.info(error)
    ^^^^^^
NameError: name 'logger' is not defined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/title_generator.py", line 38, in generate_title
    success, response, error = retry_with_backoff(ai_call)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/retry_with_backoff.py", line 21, in retry_with_backoff
    logger.info(error)
    ^^^^^^
NameError: name 'logger' is not defined
[2025-11-15 00:36:51,055] INFO: → Fetching Amazon prices for sub-products...
[2025-11-15 00:36:51,056] WARNING: No sub-products identified, skipping price fetch
[2025-11-15 00:36:51,056] INFO: [7/10] Processing: 5 x Canon Pixma multipack printer cartridges
[2025-11-15 00:36:51,056] INFO: → Generating AI title...
[2025-11-15 00:36:52,243] ERROR: Error generating title: name 'logger' is not defined
Traceback (most recent call last):
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/retry_with_backoff.py", line 17, in retry_with_backoff
    result = func()
             ^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/openai_model.py", line 58, in call_openai
    return self.client.chat.completions.create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/venv/lib/python3.12/site-packages/openai/_utils/_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/venv/lib/python3.12/site-packages/openai/resources/chat/completions/completions.py", line 1189, in create
    return self._post(
           ^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/venv/lib/python3.12/site-packages/openai/_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/venv/lib/python3.12/site-packages/openai/_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
openai.BadRequestError: Error code: 400 - {'error': {'message': 'Error while downloading https://scontent.ftas4-4.fna.fbcdn.net/v/t45.5328-4/579077731_1751853695518285_2626475647668514558_n.jpg?stp=dst-jpg_s960x960_tt6&_nc_cat=109&ccb=1-7&_nc_sid=247b10&_nc_ohc=Vpdm0I4OdnQQ7kNvwHFqBHC&_nc_oc=AdkN0jv1IJrx-JKwH5rVQQi5ss6P18U_BcSelxJrEnTRrU5kbE7WHAqA8PeRtQL-lZs&_nc_zt=23&_nc_ht=scontent.ftas4-4.fna&_nc_gid=-QTsu-Xsso_f-0RbedW4Lw&oh=00_AfgUqjDQuxirNZeNlRvwFKjR3NGdfiMKCcclACsPUDHslg&oe=691D93A9.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_image_url'}}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/retry_with_backoff.py", line 17, in retry_with_backoff
    result = func()
             ^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/title_generator.py", line 36, in ai_call
    return self.ai_router.generate_title(prompt, image_urls, schema)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/ai_model_router.py", line 69, in generate_title
    return model.generate_title(prompt, image_urls, schema)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/openai_model.py", line 70, in generate_title
    success, response, error = retry_with_backoff(call_openai)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/retry_with_backoff.py", line 21, in retry_with_backoff
    logger.info(error)
    ^^^^^^
NameError: name 'logger' is not defined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/title_generator.py", line 38, in generate_title
    success, response, error = retry_with_backoff(ai_call)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/retry_with_backoff.py", line 21, in retry_with_backoff
    logger.info(error)
    ^^^^^^
NameError: name 'logger' is not defined
[2025-11-15 00:36:52,253] INFO: → Fetching Amazon prices for sub-products...
[2025-11-15 00:36:52,253] WARNING: No sub-products identified, skipping price fetch
[2025-11-15 00:36:52,262] INFO: [8/10] Processing: FS: Brand New Sealed Genuine Canon Cartridge 312 Printer Black Toner for LBP3050 LBP3100 LBP3150
[2025-11-15 00:36:52,262] INFO: → Generating AI title...
[2025-11-15 00:36:53,472] ERROR: Error generating title: name 'logger' is not defined
Traceback (most recent call last):
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/retry_with_backoff.py", line 17, in retry_with_backoff
    result = func()
             ^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/openai_model.py", line 58, in call_openai
    return self.client.chat.completions.create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/venv/lib/python3.12/site-packages/openai/_utils/_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/venv/lib/python3.12/site-packages/openai/resources/chat/completions/completions.py", line 1189, in create
    return self._post(
           ^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/venv/lib/python3.12/site-packages/openai/_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/venv/lib/python3.12/site-packages/openai/_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
openai.BadRequestError: Error code: 400 - {'error': {'message': 'Error while downloading https://scontent.ftas4-1.fna.fbcdn.net/v/t45.5328-4/578615201_651140181412754_5702426106531428562_n.jpg?stp=dst-jpg_s960x960_tt6&_nc_cat=107&ccb=1-7&_nc_sid=247b10&_nc_ohc=M6WWepTTxNMQ7kNvwGPHaqC&_nc_oc=Adm3V1BVMbm0nBBuo4zU5ZYCoT8xgX455MFjlpAqnmoFnO_fBsVSiaVPHKOgIqqKpr8&_nc_zt=23&_nc_ht=scontent.ftas4-1.fna&_nc_gid=Va29sT1mYj3CEaiEjaMnPA&oh=00_AfjtC-ezQpcCvaful9784XIp7oGfBR_dqyvmAQdnzNqXeA&oe=691D9030.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_image_url'}}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/retry_with_backoff.py", line 17, in retry_with_backoff
    result = func()
             ^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/title_generator.py", line 36, in ai_call
    return self.ai_router.generate_title(prompt, image_urls, schema)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/ai_model_router.py", line 69, in generate_title
    return model.generate_title(prompt, image_urls, schema)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/openai_model.py", line 70, in generate_title
    success, response, error = retry_with_backoff(call_openai)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/retry_with_backoff.py", line 21, in retry_with_backoff
    logger.info(error)
    ^^^^^^
NameError: name 'logger' is not defined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/title_generator.py", line 38, in generate_title
    success, response, error = retry_with_backoff(ai_call)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/retry_with_backoff.py", line 21, in retry_with_backoff
    logger.info(error)
    ^^^^^^
NameError: name 'logger' is not defined
[2025-11-15 00:36:53,481] INFO: → Fetching Amazon prices for sub-products...
[2025-11-15 00:36:53,482] WARNING: No sub-products identified, skipping price fetch
[2025-11-15 00:36:53,490] INFO: [9/10] Processing: Canon Ink Cartridges
[2025-11-15 00:36:53,490] INFO: → Generating AI title...
[2025-11-15 00:37:01,050] ERROR: Error generating title: name 'logger' is not defined
Traceback (most recent call last):
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/retry_with_backoff.py", line 17, in retry_with_backoff
    result = func()
             ^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/openai_model.py", line 58, in call_openai
    return self.client.chat.completions.create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/venv/lib/python3.12/site-packages/openai/_utils/_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/venv/lib/python3.12/site-packages/openai/resources/chat/completions/completions.py", line 1189, in create
    return self._post(
           ^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/venv/lib/python3.12/site-packages/openai/_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/venv/lib/python3.12/site-packages/openai/_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
openai.BadRequestError: Error code: 400 - {'error': {'message': 'Error while downloading https://scontent.ftas4-1.fna.fbcdn.net/v/t39.84726-6/582382875_2677417449272000_2854008920344558333_n.jpg?stp=dst-jpg_p720x720_tt6&_nc_cat=100&ccb=1-7&_nc_sid=92e707&_nc_ohc=ltlVC3hJ6h8Q7kNvwEOCt-S&_nc_oc=Adm1xZlwaF2-8v_wXeji00we_UxafTOJpTVPcL68A-2zU06GuCvAh4QdGnU5rgoYqY4&_nc_zt=14&_nc_ht=scontent.ftas4-1.fna&_nc_gid=QzG_v0y7jdhWF5M2DHeH8g&oh=00_AfhQ3Y4TSMNbFtZyzCcZJNuo3TLAwql1P0nfi87e_APL3g&oe=691DB589.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_image_url'}}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/retry_with_backoff.py", line 17, in retry_with_backoff
    result = func()
             ^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/title_generator.py", line 36, in ai_call
    return self.ai_router.generate_title(prompt, image_urls, schema)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/ai_model_router.py", line 69, in generate_title
    return model.generate_title(prompt, image_urls, schema)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/openai_model.py", line 70, in generate_title
    success, response, error = retry_with_backoff(call_openai)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/retry_with_backoff.py", line 21, in retry_with_backoff
    logger.info(error)
    ^^^^^^
NameError: name 'logger' is not defined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/title_generator.py", line 38, in generate_title
    success, response, error = retry_with_backoff(ai_call)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/retry_with_backoff.py", line 21, in retry_with_backoff
    logger.info(error)
    ^^^^^^
NameError: name 'logger' is not defined
[2025-11-15 00:37:01,057] INFO: → Fetching Amazon prices for sub-products...
[2025-11-15 00:37:01,057] WARNING: No sub-products identified, skipping price fetch
[2025-11-15 00:37:01,065] INFO: [10/10] Processing: Canon imageprograf PRO-300 printer
[2025-11-15 00:37:01,065] INFO: → Generating AI title...
[2025-11-15 00:37:06,373] ERROR: Error generating title: name 'logger' is not defined
Traceback (most recent call last):
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/retry_with_backoff.py", line 17, in retry_with_backoff
    result = func()
             ^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/openai_model.py", line 58, in call_openai
    return self.client.chat.completions.create(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/venv/lib/python3.12/site-packages/openai/_utils/_utils.py", line 286, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/venv/lib/python3.12/site-packages/openai/resources/chat/completions/completions.py", line 1189, in create
    return self._post(
           ^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/venv/lib/python3.12/site-packages/openai/_base_client.py", line 1259, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/venv/lib/python3.12/site-packages/openai/_base_client.py", line 1047, in request
    raise self._make_status_error_from_response(err.response) from None
openai.BadRequestError: Error code: 400 - {'error': {'message': 'Error while downloading https://scontent.ftas4-4.fna.fbcdn.net/v/t45.5328-4/578579492_2074973269980364_8033813147026521326_n.jpg?stp=dst-jpg_s960x960_tt6&_nc_cat=109&ccb=1-7&_nc_sid=247b10&_nc_ohc=YE6dkp93a_0Q7kNvwFK05lS&_nc_oc=AdldBwENqJHXgHin-urPxOtrYbQ83ISkfY9WX_683e-wseoddXXwc4I0d9c-9JYUPfM&_nc_zt=23&_nc_ht=scontent.ftas4-4.fna&_nc_gid=gE03hSZv10nURIEcN7sjBA&oh=00_AfjovO5_Oy23elRc_gOehL8ZPtbr0yM9Y18IM9xap9akSg&oe=691DB1E7.', 'type': 'invalid_request_error', 'param': None, 'code': 'invalid_image_url'}}

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/retry_with_backoff.py", line 17, in retry_with_backoff
    result = func()
             ^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/title_generator.py", line 36, in ai_call
    return self.ai_router.generate_title(prompt, image_urls, schema)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/ai_model_router.py", line 69, in generate_title
    return model.generate_title(prompt, image_urls, schema)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/openai_model.py", line 70, in generate_title
    success, response, error = retry_with_backoff(call_openai)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/retry_with_backoff.py", line 21, in retry_with_backoff
    logger.info(error)
    ^^^^^^
NameError: name 'logger' is not defined

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/title_generator.py", line 38, in generate_title
    success, response, error = retry_with_backoff(ai_call)
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/ai_product_analyzer/retry_with_backoff.py", line 21, in retry_with_backoff
    logger.info(error)
    ^^^^^^
NameError: name 'logger' is not defined
[2025-11-15 00:37:06,377] INFO: → Fetching Amazon prices for sub-products...
[2025-11-15 00:37:06,377] WARNING: No sub-products identified, skipping price fetch
[2025-11-15 00:37:06,378] INFO: 
✅ Processing complete for all 10 products
[2025-11-15 00:37:06,380] INFO: ✅ PIPELINE COMPLETED SUCCESSFULLY
[2025-11-15 00:37:06,382] INFO: Task completed successfully
