[2025-11-13 15:30:18,067] INFO: Task received by worker
[2025-11-13 15:30:18,067] INFO: Starting task: Facebook Marketplace Scraper
[2025-11-13 15:30:18,068] DEBUG: Input data: {
  "cities": [
    "london",
    "manchester"
  ],
  "query": "Canon Printer Cartridge",
  "last_n_days": 7,
  "listings_per_city": 100
}
[2025-11-13 15:30:18,072] INFO: AADSASDASDASDASDASSDFSDFSDKFHSDKJFHKDSHKJHkjhjhkjhkj
[2025-11-13 15:30:18,072] INFO: Scraping 2 city(s): london, manchester
[2025-11-13 15:30:18,073] INFO: ================================================================================
[2025-11-13 15:30:18,074] INFO: üöÄ FACEBOOK MARKETPLACE SCRAPER
[2025-11-13 15:30:18,074] INFO: ================================================================================
[2025-11-13 15:30:18,074] INFO: üìã Configuration:
[2025-11-13 15:30:18,074] INFO:    Query: "Canon Printer Cartridge"
[2025-11-13 15:30:18,074] INFO:    Cities: london, manchester
[2025-11-13 15:30:18,074] INFO:    Days: 7
[2025-11-13 15:30:18,074] INFO:    Listings per city: 100
[2025-11-13 15:30:18,074] INFO:    Cookies file: Facebook Marketplace Scraper - 171 (STARTED)
[2025-11-13 15:30:18,075] INFO: ================================================================================
[2025-11-13 15:30:21,493] INFO: 
üîê LOGIN PROCESS
[2025-11-13 15:30:21,493] INFO: --------------------------------------------------------------------------------
[2025-11-13 15:30:21,524] INFO: ‚úÖ Cookies loaded. Checking session...
[2025-11-13 15:30:33,902] INFO: ‚úÖ Session is valid.
[2025-11-13 15:30:33,902] INFO: 
üåç SCRAPING CITIES
[2025-11-13 15:30:33,902] INFO: --------------------------------------------------------------------------------
[2025-11-13 15:30:33,902] INFO: 
üìç City 1/2: London
[2025-11-13 15:30:33,902] INFO: --------------------------------------------------------------------------------
[2025-11-13 15:30:33,902] INFO: üîó URL: https://www.facebook.com/marketplace/london/search?daysSinceListed=7&sortBy=best_match&query=Canon%20Printer%20Cartridge
[2025-11-13 15:30:34,229] INFO: ‚è≥ Loading marketplace page...
[2025-11-13 15:30:36,214] INFO:   üìÑ HTML ‚Üí 24 items
[2025-11-13 15:30:36,787] INFO:   ‚è≥ Scraping up to 100 listings...
[2025-11-13 15:30:51,789] INFO:     üîÑ Iteration 1
[2025-11-13 15:30:51,790] INFO:     ‚úÖ Found 24 new items. Total: 0/100 | Total unique: 0
[2025-11-13 15:30:56,763] INFO:       [1/24] Processed 724021280062561... (1/100)
[2025-11-13 15:30:56,763] INFO:       Title: Genuine CANON ink cartridges for PIXMA printer (CLI-551/PGI-550) | Price: 22.00
[2025-11-13 15:31:01,481] INFO:       [2/24] Processed 1554036418929335... (2/100)
[2025-11-13 15:31:01,481] INFO:       Title: Canon Printer Cartridge XL 540 | Price: 15.00
[2025-11-13 15:31:07,218] INFO:       [3/24] Processed 25439726585661717... (3/100)
[2025-11-13 15:31:07,218] INFO:       Title: Canon Printer Cartridge Pixma 561 XL | Price: 15.00
[2025-11-13 15:31:12,995] INFO:       [4/24] Processed 1165421041786090... (4/100)
[2025-11-13 15:31:12,996] INFO:       Title: Ink Cartridges - Canon | Price: 10.00
[2025-11-13 15:31:16,644] INFO:       [5/24] Processed 2634536553592425... (5/100)
[2025-11-13 15:31:16,645] INFO:       Title: Canon Printer Cartridges | Price: 12.00
[2025-11-13 15:31:21,248] INFO:       [6/24] Processed 821587960580790... (6/100)
[2025-11-13 15:31:21,249] INFO:       Title: 5 x Canon Pixma multipack printer cartridges | Price: 100.00
[2025-11-13 15:31:26,697] INFO:       [7/24] Processed 4200158923604827... (7/100)
[2025-11-13 15:31:26,697] INFO:       Title: Canon 545 XL printer cartridge | Price: 10.00
[2025-11-13 15:31:32,486] INFO:       [8/24] Processed 1409378457250684... (8/100)
[2025-11-13 15:31:32,486] INFO:       Title: Canon SELPHY Square mini photo printer with brand new ink cartridge | Price: 90.00
[2025-11-13 15:31:38,347] INFO:       [9/24] Processed 1533404871411826... (9/100)
[2025-11-13 15:31:38,347] INFO:       Title: Canon pixma printer and black ink cartridge | Price: 35.00
[2025-11-13 15:31:44,399] INFO:       [10/24] Processed 1791296661521210... (10/100)
[2025-11-13 15:31:44,400] INFO:       Title: Canon MG4150 printer | Price: 0.00
[2025-11-13 15:31:48,066] INFO:       [11/24] Processed 804443662396158... (11/100)
[2025-11-13 15:31:48,067] INFO:       Title: 10x printer in cartridges. | Price: 20.00
[2025-11-13 15:31:53,215] INFO:       [12/24] Processed 1595795774739741... (12/100)
[2025-11-13 15:31:53,215] INFO:       Title: Canon Ink cartridges mixed bundle-open to offers | Price: 350.00
[2025-11-13 15:31:58,979] INFO:       [13/24] Processed 1996643580893125... (13/100)
[2025-11-13 15:31:58,979] INFO:       Title: Canon imageprograf PRO-300 printer | Price: 200.00
[2025-11-13 15:32:02,691] INFO:       [14/24] Processed 805123005626129... (14/100)
[2025-11-13 15:32:02,692] INFO:       Title: Canon IPF6400 24‚Äù colour printer | Price: 0.00
[2025-11-13 15:32:08,331] INFO:       [15/24] Processed 867863309009116... (15/100)
[2025-11-13 15:32:08,331] INFO:       Title: FS: Brand New Sealed Genuine Canon Cartridge 312 Printer Black Toner for LBP3050 LBP3100 LBP3150 | Price: 20.00
[2025-11-13 15:32:10,794] INFO:   üìä GraphQL ‚Üí 24 items
[2025-11-13 15:32:11,950] INFO:       [16/24] Processed 1522001412469948... (16/100)
[2025-11-13 15:32:11,951] INFO:       Title: Canon Pixma MP495 Printer and Ink Cartridges | Price: 20.00
[2025-11-13 17:30:18,072] ERROR: Task failed: SoftTimeLimitExceeded()
Traceback (most recent call last):
  File "/usr/lib/python3.12/asyncio/runners.py", line 194, in run
    return runner.run(main)
           ^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
  File "/usr/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1949, in _run_once
    event_list = self._selector.select(timeout)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/selectors.py", line 468, in select
    fd_event_list = self._selector.poll(timeout, max_ev)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/venv/lib/python3.12/site-packages/billiard/common.py", line 106, in _shutdown_cleanup
    sys.exit(-(256 - signum))
  File "/home/akhliddin/Desktop/ScriptifyBackend/venv/lib/python3.12/site-packages/billiard/pool.py", line 283, in exit
    return _exit(status)
           ^^^^^^^^^^^^^
SystemExit: -241

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/tasks.py", line 46, in execute_script_task
    result = scrape_facebook_marketplace(run, script, input_data, logger, writer)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/venv/lib/python3.12/site-packages/celery/local.py", line 182, in __call__
    return self._get_current_object()(*a, **kw)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/venv/lib/python3.12/site-packages/celery/app/trace.py", line 737, in __protected_call__
    return orig(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/venv/lib/python3.12/site-packages/celery/app/task.py", line 411, in __call__
    return self.run(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/tasks.py", line 193, in scrape_facebook_marketplace
    return facebook_scraper.start_scraping()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/apps/scripts/facebook_scraper/facebook_scraper_main.py", line 162, in start_scraping
    asyncio.run(self._async_main())
  File "/usr/lib/python3.12/asyncio/runners.py", line 193, in run
    with Runner(debug=debug, loop_factory=loop_factory) as runner:
  File "/usr/lib/python3.12/asyncio/runners.py", line 62, in __exit__
    self.close()
  File "/usr/lib/python3.12/asyncio/runners.py", line 70, in close
    _cancel_all_tasks(loop)
  File "/usr/lib/python3.12/asyncio/runners.py", line 205, in _cancel_all_tasks
    loop.run_until_complete(tasks.gather(*to_cancel, return_exceptions=True))
  File "/usr/lib/python3.12/asyncio/base_events.py", line 674, in run_until_complete
    self.run_forever()
  File "/usr/lib/python3.12/asyncio/base_events.py", line 641, in run_forever
    self._run_once()
  File "/usr/lib/python3.12/asyncio/base_events.py", line 1949, in _run_once
    event_list = self._selector.select(timeout)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/selectors.py", line 468, in select
    fd_event_list = self._selector.poll(timeout, max_ev)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/akhliddin/Desktop/ScriptifyBackend/venv/lib/python3.12/site-packages/billiard/pool.py", line 228, in soft_timeout_sighandler
    raise SoftTimeLimitExceeded()
billiard.exceptions.SoftTimeLimitExceeded: SoftTimeLimitExceeded()

